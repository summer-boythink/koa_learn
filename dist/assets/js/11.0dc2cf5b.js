(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{412:function(t,s,e){"use strict";e.r(s);var n=e(56),a=Object(n.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"其余模块做了什么"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其余模块做了什么"}},[t._v("#")]),t._v(" 其余模块做了什么")]),t._v(" "),e("p",[t._v("上一节我们讲到"),e("code",[t._v("Object.create(context)")]),t._v(",\n现在我们来看看"),e("code",[t._v("context")]),t._v(","),e("code",[t._v("request")]),t._v(","),e("code",[t._v("response")]),t._v("这些模块做了什么")]),t._v(" "),e("h2",{attrs:{id:"context"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[t._v("#")]),t._v(" context")]),t._v(" "),e("p",[e("img",{attrs:{src:"/imgs/3.png",alt:""}})]),t._v(" "),e("p",[t._v("最后导出的"),e("code",[t._v("context")]),t._v("是一个"),e("code",[t._v("Object")]),t._v("类型，这个类型里有一些方法,比如"),e("code",[t._v("onerrer")]),t._v(","),e("code",[t._v("inspect")]),t._v("之类")]),t._v(" "),e("p",[e("img",{attrs:{src:"/imgs/5.png",alt:""}})]),t._v(" "),e("p",[t._v("这一部分除了导出的对象外，更有意思的部分是下面的"),e("code",[t._v("delegate")]),t._v(",还记得我们的"),e("RouterLink",{attrs:{to:"/koa/preposition/1.html"}},[t._v("前置知识点一")]),t._v("吗")],1),t._v(" "),e("p",[t._v("这一部分的源码注释如下")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("delegate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("proto"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'response'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当访问proto[以下属性]时,用proto.response[以下属性]回应")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("method")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'attachment'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//method表示这类属性是函数")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("access")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'status'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//access表示这类属性可以可读可写")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'headerSent'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//getter表示这类属性只读")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])]),e("p",[t._v("这里的意思，其实就是当我们访问"),e("code",[t._v("proto")]),t._v("上面的方法或者属性，我们让"),e("code",[t._v("proto.response")]),t._v("上的同名属性或方法来回应这些访问，\n"),e("code",[t._v("proto")]),t._v("是什么，就是我们"),e("code",[t._v("exports")]),t._v("出去的那个模块，就是"),e("code",[t._v("context")])]),t._v(" "),e("p",[t._v("所以这一段意思就是，访问"),e("code",[t._v("context")]),t._v("上面某个属性，我们用"),e("code",[t._v("context.response")]),t._v("上的同名属性回应")]),t._v(" "),e("p",[t._v("你有没有想起来，我们在使用koa时，我们用"),e("code",[t._v("ctx.body")]),t._v(",但是"),e("code",[t._v("body")]),t._v("这个属性真的在"),e("code",[t._v("ctx")]),t._v("上吗?\n接下来，我们来看看"),e("code",[t._v("response")]),t._v("这个模块")]),t._v(" "),e("h2",{attrs:{id:"response和request"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#response和request"}},[t._v("#")]),t._v(" response和request")]),t._v(" "),e("p",[e("img",{attrs:{src:"/imgs/7.png",alt:"request"}})]),t._v(" "),e("p",[t._v("↑ "),e("code",[t._v("request")]),t._v("部分")]),t._v(" "),e("p",[e("img",{attrs:{src:"/imgs/8.png",alt:"response"}})]),t._v(" "),e("p",[t._v("↑ "),e("code",[t._v("response")]),t._v("部分")]),t._v(" "),e("p",[t._v("这两张其实分别对应的就是我们访问一个网页时，"),e("code",[t._v("request headers")]),t._v("和"),e("code",[t._v("response headers")]),t._v("的内容")]),t._v(" "),e("p",[t._v("然后，聪明可爱的你应该注意到了，在第二张图中，有"),e("code",[t._v("(get) body")]),t._v(",说明当我们访问"),e("code",[t._v("ctx.body")]),t._v("时候，\n实际上，处理属性访问的是"),e("code",[t._v("ctx.response.body")]),t._v(".")])])}),[],!1,null,null,null);s.default=a.exports}}]);